#!/bin/bash

if(false); then
    buffSize="50000000" # nanomsg buffer size is in bytes
else
    buffSize="1000" # zeromq high-water mark is in messages
fi

ID="101"
eventSize="1000"
numIoThreads="1"
outputSocketType="push"
outputBufSize=$buffSize
outputMethod="bind"
outputAddress="tcp://*:5565"
xterm -e @CMAKE_BINARY_DIR@/bin/testFLP $ID $eventSize $numIoThreads $outputSocketType $outputBufSize $outputMethod $outputAddress &

ID="102"
eventSize="10000"
numIoThreads="1"
outputSocketType="push"
outputBufSize=$buffSize
outputMethod="bind"
outputAddress="tcp://*:5566"
xterm -e @CMAKE_BINARY_DIR@/bin/testFLP $ID $eventSize $numIoThreads $outputSocketType $outputBufSize $outputMethod $outputAddress &

ID="103"
eventSize="10000"
numIoThreads="1"
outputSocketType="push"
outputBufSize=$buffSize
outputMethod="bind"
outputAddress="tcp://*:5567"
xterm -e @CMAKE_BINARY_DIR@/bin/testFLP $ID $eventSize $numIoThreads $outputSocketType $outputBufSize $outputMethod $outputAddress &

ID="501"
numIoThreads="1"
numInputs="3"

inputSocketType1="pull"
inputRcvBufSize1=$buffSize
inputMethod1="connect"
inputAddress1="tcp://localhost:5565"

inputSocketType2="pull"
inputRcvBufSize2=$buffSize
inputMethod2="connect"
inputAddress2="tcp://localhost:5566"

inputSocketType3="pull"
inputRcvBufSize3=$buffSize
inputMethod3="connect"
inputAddress3="tcp://localhost:5567"

outputSocketType="push"
outputSndBufSize=$buffSize
outputMethod="bind"
outputAddress="tcp://*:5581"
xterm -e @CMAKE_BINARY_DIR@/bin/testMerger $ID $numIoThreads $numInputs $inputSocketType1 $inputRcvBufSize1 $inputMethod1 $inputAddress1 $inputSocketType2 $inputRcvBufSize2 $inputMethod2 $inputAddress2  $inputSocketType3 $inputRcvBufSize3 $inputMethod3 $inputAddress3 $outputSocketType $outputSndBufSize $outputMethod $outputAddress &

ID="201"
numIoThreads="1"
inputSocketType="pull"
inputRcvBufSize=$buffSize
inputMethod="connect"
inputAddress="tcp://localhost:5581"
outputSocketType="push"
outputSndBufSize=$buffSize
outputMethod="bind"
outputAddress="tcp://*:5582"
xterm -e @CMAKE_BINARY_DIR@/bin/testProxy $ID $numIoThreads $inputSocketType $inputRcvBufSize $inputMethod $inputAddress $outputSocketType $outputSndBufSize $outputMethod $outputAddress &

ID="301"
numIoThreads="1"
inputSocketType="pull"
inputRcvBufSize=$buffSize
inputMethod="connect"
inputAddress="tcp://localhost:5582"
xterm -e @CMAKE_BINARY_DIR@/bin/testEPN $ID $numIoThreads $inputSocketType $inputRcvBufSize $inputMethod $inputAddress &

ID="302"
numIoThreads="1"
inputSocketType="pull"
inputRcvBufSize=$buffSize
inputMethod="connect"
inputAddress="tcp://localhost:5582"
xterm -e @CMAKE_BINARY_DIR@/bin/testEPN $ID $numIoThreads $inputSocketType $inputRcvBufSize $inputMethod $inputAddress &

ID="303"
numIoThreads="1"
inputSocketType="pull"
inputRcvBufSize=$buffSize
inputMethod="connect"
inputAddress="tcp://localhost:5582"
xterm -e @CMAKE_BINARY_DIR@/bin/testEPN $ID $numIoThreads $inputSocketType $inputRcvBufSize $inputMethod $inputAddress &

ID="304"
numIoThreads="1"
inputSocketType="pull"
inputRcvBufSize=$buffSize
inputMethod="connect"
inputAddress="tcp://localhost:5582"
xterm -e @CMAKE_BINARY_DIR@/bin/testEPN $ID $numIoThreads $inputSocketType $inputRcvBufSize $inputMethod $inputAddress &
